{"ast":null,"code":"import _pt from \"prop-types\";\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nimport React from 'react';\nimport vegaEmbed from 'vega-embed';\nimport shallowEqual from './utils/shallowEqual';\nimport getUniqueFieldNames from './utils/getUniqueFieldNames';\nimport { NOOP } from './constants';\nimport addSignalListenersToView from './utils/addSignalListenersToView';\nimport computeSpecChanges from './utils/computeSpecChanges';\nimport removeSignalListenersFromView from './utils/removeSignalListenersFromView';\nimport combineSpecWithDimension from './utils/combineSpecWithDimension';\nexport default class VegaEmbed extends React.PureComponent {\n  constructor() {\n    super(...arguments);\n\n    _defineProperty(this, \"containerRef\", /*#__PURE__*/React.createRef());\n\n    _defineProperty(this, \"resultPromise\", void 0);\n\n    _defineProperty(this, \"handleError\", error => {\n      const {\n        onError = NOOP\n      } = this.props;\n      onError(error, this.containerRef.current); // eslint-disable-next-line no-console\n\n      console.warn(error);\n      return undefined;\n    });\n\n    _defineProperty(this, \"modifyView\", action => {\n      if (this.resultPromise) {\n        this.resultPromise.then(result => {\n          if (result) {\n            action(result.view);\n          }\n\n          return true;\n        }).catch(this.handleError);\n      }\n    });\n  }\n\n  componentDidMount() {\n    this.createView();\n  }\n\n  componentDidUpdate(prevProps) {\n    const fieldSet = getUniqueFieldNames([this.props, prevProps]);\n    fieldSet.delete('className');\n    fieldSet.delete('signalListeners');\n    fieldSet.delete('spec');\n    fieldSet.delete('style');\n    fieldSet.delete('width');\n    fieldSet.delete('height'); // Only create a new view if necessary\n\n    if (Array.from(fieldSet).some(f => this.props[f] !== prevProps[f])) {\n      this.clearView();\n      this.createView();\n    } else {\n      const specChanges = computeSpecChanges(combineSpecWithDimension(this.props), combineSpecWithDimension(prevProps));\n      const {\n        signalListeners: newSignalListeners\n      } = this.props;\n      const {\n        signalListeners: oldSignalListeners\n      } = prevProps;\n\n      if (specChanges) {\n        if (specChanges.isExpensive) {\n          this.clearView();\n          this.createView();\n        } else {\n          const areSignalListenersChanged = !shallowEqual(newSignalListeners, oldSignalListeners);\n          this.modifyView(view => {\n            if (specChanges.width !== false) {\n              view.width(specChanges.width);\n            }\n\n            if (specChanges.height !== false) {\n              view.height(specChanges.height);\n            }\n\n            if (areSignalListenersChanged) {\n              if (oldSignalListeners) {\n                removeSignalListenersFromView(view, oldSignalListeners);\n              }\n\n              if (newSignalListeners) {\n                addSignalListenersToView(view, newSignalListeners);\n              }\n            }\n\n            view.run();\n          });\n        }\n      } else if (!shallowEqual(newSignalListeners, oldSignalListeners)) {\n        this.modifyView(view => {\n          if (oldSignalListeners) {\n            removeSignalListenersFromView(view, oldSignalListeners);\n          }\n\n          if (newSignalListeners) {\n            addSignalListenersToView(view, newSignalListeners);\n          }\n\n          view.run();\n        });\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    this.clearView();\n  }\n\n  createView() {\n    const {\n      spec,\n      onNewView,\n      signalListeners = {},\n      width,\n      height,\n      ...options\n    } = this.props;\n\n    if (this.containerRef.current) {\n      const finalSpec = combineSpecWithDimension(this.props);\n      this.resultPromise = vegaEmbed(this.containerRef.current, finalSpec, options).then(result => {\n        if (result) {\n          const {\n            view\n          } = result;\n\n          if (addSignalListenersToView(view, signalListeners)) {\n            view.run();\n          }\n        }\n\n        return result;\n      }).catch(this.handleError);\n\n      if (onNewView) {\n        this.modifyView(onNewView);\n      }\n    }\n  }\n\n  clearView() {\n    if (this.resultPromise) {\n      this.resultPromise.then(result => {\n        if (result) {\n          result.finalize();\n        }\n      }).catch(this.handleError);\n    }\n\n    this.resultPromise = undefined;\n    return this;\n  }\n\n  render() {\n    const {\n      className,\n      style\n    } = this.props; // Create the container Vega draws inside\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      ref: this.containerRef,\n      className: className,\n      style: style\n    });\n  }\n\n}\n\n_defineProperty(VegaEmbed, \"propTypes\", {\n  className: _pt.string,\n  onError: _pt.func\n});","map":{"version":3,"names":["_pt","_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","React","vegaEmbed","shallowEqual","getUniqueFieldNames","NOOP","addSignalListenersToView","computeSpecChanges","removeSignalListenersFromView","combineSpecWithDimension","VegaEmbed","PureComponent","constructor","arguments","createRef","error","onError","props","containerRef","current","console","warn","undefined","action","resultPromise","then","result","view","catch","handleError","componentDidMount","createView","componentDidUpdate","prevProps","fieldSet","delete","Array","from","some","f","clearView","specChanges","signalListeners","newSignalListeners","oldSignalListeners","isExpensive","areSignalListenersChanged","modifyView","width","height","run","componentWillUnmount","spec","onNewView","options","finalSpec","finalize","render","className","style","createElement","ref","string","func"],"sources":["/Users/darcyroche/Documents/cathracha is tíreolaíocht/public life observations/plo-viz-app/node_modules/react-vega/esm/VegaEmbed.js"],"sourcesContent":["import _pt from \"prop-types\";\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from 'react';\nimport vegaEmbed from 'vega-embed';\nimport shallowEqual from './utils/shallowEqual';\nimport getUniqueFieldNames from './utils/getUniqueFieldNames';\nimport { NOOP } from './constants';\nimport addSignalListenersToView from './utils/addSignalListenersToView';\nimport computeSpecChanges from './utils/computeSpecChanges';\nimport removeSignalListenersFromView from './utils/removeSignalListenersFromView';\nimport combineSpecWithDimension from './utils/combineSpecWithDimension';\nexport default class VegaEmbed extends React.PureComponent {\n  constructor() {\n    super(...arguments);\n\n    _defineProperty(this, \"containerRef\", /*#__PURE__*/React.createRef());\n\n    _defineProperty(this, \"resultPromise\", void 0);\n\n    _defineProperty(this, \"handleError\", error => {\n      const {\n        onError = NOOP\n      } = this.props;\n      onError(error, this.containerRef.current); // eslint-disable-next-line no-console\n\n      console.warn(error);\n      return undefined;\n    });\n\n    _defineProperty(this, \"modifyView\", action => {\n      if (this.resultPromise) {\n        this.resultPromise.then(result => {\n          if (result) {\n            action(result.view);\n          }\n\n          return true;\n        }).catch(this.handleError);\n      }\n    });\n  }\n\n  componentDidMount() {\n    this.createView();\n  }\n\n  componentDidUpdate(prevProps) {\n    const fieldSet = getUniqueFieldNames([this.props, prevProps]);\n    fieldSet.delete('className');\n    fieldSet.delete('signalListeners');\n    fieldSet.delete('spec');\n    fieldSet.delete('style');\n    fieldSet.delete('width');\n    fieldSet.delete('height'); // Only create a new view if necessary\n\n    if (Array.from(fieldSet).some(f => this.props[f] !== prevProps[f])) {\n      this.clearView();\n      this.createView();\n    } else {\n      const specChanges = computeSpecChanges(combineSpecWithDimension(this.props), combineSpecWithDimension(prevProps));\n      const {\n        signalListeners: newSignalListeners\n      } = this.props;\n      const {\n        signalListeners: oldSignalListeners\n      } = prevProps;\n\n      if (specChanges) {\n        if (specChanges.isExpensive) {\n          this.clearView();\n          this.createView();\n        } else {\n          const areSignalListenersChanged = !shallowEqual(newSignalListeners, oldSignalListeners);\n          this.modifyView(view => {\n            if (specChanges.width !== false) {\n              view.width(specChanges.width);\n            }\n\n            if (specChanges.height !== false) {\n              view.height(specChanges.height);\n            }\n\n            if (areSignalListenersChanged) {\n              if (oldSignalListeners) {\n                removeSignalListenersFromView(view, oldSignalListeners);\n              }\n\n              if (newSignalListeners) {\n                addSignalListenersToView(view, newSignalListeners);\n              }\n            }\n\n            view.run();\n          });\n        }\n      } else if (!shallowEqual(newSignalListeners, oldSignalListeners)) {\n        this.modifyView(view => {\n          if (oldSignalListeners) {\n            removeSignalListenersFromView(view, oldSignalListeners);\n          }\n\n          if (newSignalListeners) {\n            addSignalListenersToView(view, newSignalListeners);\n          }\n\n          view.run();\n        });\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    this.clearView();\n  }\n\n  createView() {\n    const {\n      spec,\n      onNewView,\n      signalListeners = {},\n      width,\n      height,\n      ...options\n    } = this.props;\n\n    if (this.containerRef.current) {\n      const finalSpec = combineSpecWithDimension(this.props);\n      this.resultPromise = vegaEmbed(this.containerRef.current, finalSpec, options).then(result => {\n        if (result) {\n          const {\n            view\n          } = result;\n\n          if (addSignalListenersToView(view, signalListeners)) {\n            view.run();\n          }\n        }\n\n        return result;\n      }).catch(this.handleError);\n\n      if (onNewView) {\n        this.modifyView(onNewView);\n      }\n    }\n  }\n\n  clearView() {\n    if (this.resultPromise) {\n      this.resultPromise.then(result => {\n        if (result) {\n          result.finalize();\n        }\n      }).catch(this.handleError);\n    }\n\n    this.resultPromise = undefined;\n    return this;\n  }\n\n  render() {\n    const {\n      className,\n      style\n    } = this.props; // Create the container Vega draws inside\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      ref: this.containerRef,\n      className: className,\n      style: style\n    });\n  }\n\n}\n\n_defineProperty(VegaEmbed, \"propTypes\", {\n  className: _pt.string,\n  onError: _pt.func\n});"],"mappings":"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"},"metadata":{},"sourceType":"module"}